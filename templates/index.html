<!DOCTYPE html>
<html lang="en">
    <style>
        /* Mobile-specific styles */
        @media (max-width: 768px) {
            .nav-buttons {
                display: flex;
                gap: 16px;
                align-items: center;
            }
            
            .nav-buttons a {
                text-decoration: none;
                color: inherit;
                font-size: 15px;
                font-weight: 500;
            }
            
            /* Completely remove button styling */
            .nav-buttons .btn {
                all: unset; /* This resets all button styles */
                cursor: pointer;
                white-space: nowrap;
            }
            
        
            
            /* Mobile menu styling - clean and minimal */
            .mobile-menu-links a {
                display: block;
                padding: 14px 20px;
                text-decoration: none;
                color: inherit;
                font-size: 16px;
                border-bottom: 1px solid rgba(0,0,0,0.05);
                transition: background-color 0.2s;
            }
            
            .mobile-menu-links a:hover {
                background-color: rgba(0,0,0,0.03);
            }
            
            /* Remove all button styling from mobile menu items */
            .mobile-menu-links .btn {
                all: unset;
                display: block;
                width: 100%;
                padding: 14px 20px;
                text-align: left;
                cursor: pointer;
                border-bottom: 1px solid rgba(0,0,0,0.05);
            }
            
            /* Special styling only for logout */
            .mobile-menu-links .btn-outline {
                margin-top: 10px;
                padding: 12px;
                text-align: center;
                border: 1px solid rgba(0,0,0,0.1);
                border-radius: 6px;
                background: transparent;
                transition: all 0.2s;
            }
            
            .mobile-menu-links .btn-outline:hover {
                background: rgba(0,0,0,0.03);
            }
        }
        
        /* Rest of your styles remain unchanged */
        .flash-messages {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
        }
        
        .alert {
            padding: 12px 20px;
            margin-bottom: 10px;
            border-radius: 4px;
            font-size: 14px;
            max-width: 400px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .card-img-photo {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px 8px 0 0;
        }
        
        .like-btn.liked {
            color: #e74c3c;
        }
        
        .like-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            transition: color 0.3s;
        }
    </style>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APP | San Ramon/Danville Secondhand Marketplace</title>
    
    <link href="{{ url_for('static', filename='assets/css/styles.css') }}" rel="stylesheet" />
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <span class="logo-icon">♻️</span> 
                OurAPP
            </div>
            <div class="nav-links">
                <a href="{{ url_for('home') }}">Home</a>
                <a href="{{ url_for('listings') }}">Browse</a>
                <a href="{{ url_for('how_it_works') }}">How It Works</a>
                {% if current_user.is_authenticated %}
                    <a href="{{ url_for('messages') }}">Messages</a>
                {% endif %}
            </div>
            <div class="nav-buttons">
                {% if current_user.is_authenticated %}
                <a href="{{ url_for('sell') }}">
                    <button class="btn" id="sell-btn">Sell Item</button>
                </a>
                    <a href="{{ url_for('liked_items') }}">
                        <button class="btn">Saved</button>
                    </a>
                    
                    <a href="{{ url_for('messages') }}">
                        <button class="btn">messages</button>
                    </a>
                    <a href="{{ url_for('logout') }}">
                        <button class="btn">Logout</button>
                    </a>
                {% else %}
                    <a href="{{ url_for('signup') }}">
                        <button class="btn">Sign Up</button>
                    </a>
                    <a href="{{ url_for('login') }}">
                        <button class="btn">Login</button>
                    </a>
                {% endif %}
            </div>
            <button class="mobile-menu-toggle" id="mobile-menu-toggle">☰</button>
        </nav>
    </header>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-messages">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobile-menu">
        <div class="mobile-menu-header">
            <div class="logo">
                <span class="logo-icon">♻️</span> 
                OurAPP
            </div>
            <button class="close-modal" id="close-mobile-menu">&times;</button>
        </div>
        <div class="mobile-menu-links">
            <a href="{{ url_for('home') }}">Home</a>
            <a href="{{ url_for('listings') }}">Browse</a>
            <a href="{{ url_for('how_it_works') }}">How It Works</a>
            {% if current_user.is_authenticated %}
                <a href="{{ url_for('messages') }}">Messages</a>
                <a href="{{ url_for('liked_items') }}">
                    <button class="btn">Saved</button>
                </a>
                <a href="{{ url_for('sell') }}">
                    <button class="btn btn-accent">Sell Item</button>
                </a>
            {% endif %}
        </div>
    </div>
    <div class="mobile-menu-overlay" id="mobile-menu-overlay"></div>
    
    <section class="hero">
        <div class="hero-content animate-slide">
            <h1>Buy and Sell Pre-loved Fashion in San Ramon & Danville</h1>
            <p>Join our local community to find quality secondhand clothes and give your wardrobe items a second life.</p>
            {% if not current_user.is_authenticated %}
                <a href="{{ url_for('signup') }}">
                    <button class="btn btn-accent" id="get-started-btn">Get Started</button>
                </a>
            {% else %}
                <a href="{{ url_for('listings') }}">
                    <button class="btn btn-accent">Browse Items</button>
                </a>
            {% endif %}
        </div>
    </section>
    
   <!-- <section class="featured-section">
        <div class="main-container">
            <div class="featured-container animate-fade">
                <div class="neighborhood-selector">
                    <form action="{{ url_for('listings') }}" method="GET">
                        <select name="neighborhood" id="neighborhood-select">
                            <option value="all">All Neighborhoods</option>
                            <option value="sanramon-valley">San Ramon Valley</option>
                            <option value="danville-downtown">Downtown Danville</option>
                            <option value="windemere">Windemere</option>
                            <option value="dougherty-valley">Dougherty Valley</option>
                            <option value="blackhawk">Blackhawk</option>
                            <option value="twin-creeks">Twin Creeks</option>
                            <option value="crow-canyon">Crow Canyon</option>
                        </select>
                        <button type="submit" class="btn">Update Location</button>
                    </form>
                </div>
                
                <div class="categories">
                    <div class="category active" data-category="all">All</div>
                    <div class="category" data-category="womens">Women's</div>
                    <div class="category" data-category="mens">Men's</div>
                    <div class="category" data-category="childrens">Children's</div>
                    <div class="category" data-category="accessories">Accessories</div>
                    <div class="category" data-category="shoes">Shoes</div>
                    <div class="category" data-category="activewear">Activewear</div>
                    <div class="category" data-category="formal">Formal</div>
                </div>
            </div>
        </div>
    </section> -->
    
    <div class="main-container">
        <section>
            <div class="section-header">
                <h2 class="section-title">Recent Listings</h2>
                <div class="view-options">
                    <a href="{{ url_for('listings') }}">
                        <button class="btn btn-outline">View All</button>
                    </a>
                </div>
            </div>
            
            <div class="listings-grid">
                {% for listing in recent_listings %}
                <div class="listing-card animate-fade">
                    <div class="card-img">
                        {% if current_user.is_authenticated %}
                            <button class="like-btn" data-listing-id="{{ listing._id }}" data-liked="false" aria-label="Like Listing">❤️</button>
                        {% endif %}
                        {% if listing.images and listing.images|length > 0 %}
                            <img src="{{ url_for('static', filename='uploads/' + listing.images[0]) }}" alt="{{ listing.title }}" class="card-img-photo">
                        {% else %}
                            <div class="card-img-placeholder">{{ listing.title }}</div>
                        {% endif %}
                        <div class="card-badge">{{ listing.condition.title() }}</div>
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">{{ listing.title }}</h3>
                        <p class="card-price">${{ "%.2f"|format(listing.price) }}</p>
                        <p class="card-location">
                            <span class="material-icons">📍</span> 
                            <span class="neighborhood-tag">{{ listing.neighborhood.replace('-', ' ').title() }}</span>
                        </p>
                        <div class="card-meta">
                            <span>Size: {{ listing.size }}</span>
                            <span>Posted: {{ listing.created_at.strftime('%b %d') }}</span>
                        </div>
                        <div class="card-actions">
                            <a href="{{ url_for('listing_detail', listing_id=listing._id) }}">
                                <button class="btn message-btn">View Details</button>
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
                
                {% if not recent_listings %}
                <div style="text-align: center; grid-column: 1 / -1; padding: 2rem;">
                    <p>No recent listings available. <a href="{{ url_for('sell') }}">Be the first to list an item!</a></p>
                </div>
                {% endif %}
            </div>
        </section>
        
        <section>
            <div class="section-header">
                <h2 class="section-title">High-end Finds</h2>
                <div class="view-options">
                    <a href="{{ url_for('listings', price_min=100) }}">
                        <button class="btn btn-outline">View All</button>
                    </a>
                </div>
            </div>
            
            <div class="listings-grid">
                {% for listing in high_end_listings %}
                <div class="listing-card animate-fade">
                    <div class="card-img">
                        
                        {% if current_user.is_authenticated %}
                            <button class="like-btn" data-listing-id="{{ listing._id }}" data-liked="false" aria-label="Like Listing">❤️</button>
                        {% endif %}
                        {% if listing.images and listing.images|length > 0 %}
                            <img src="{{ url_for('static', filename='uploads/' + listing.images[0]) }}" alt="{{ listing.title }}" class="card-img-photo">
                        {% else %}
                            <div class="card-img-placeholder">{{ listing.title }}</div>
                        {% endif %}
                        <div class="card-badge">{{ listing.condition.title() }}</div>
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">{{ listing.title }}</h3>
                        <p class="card-price">${{ "%.2f"|format(listing.price) }}</p>
                        <p class="card-location">
                            <span class="material-icons">📍</span>
                            <span class="neighborhood-tag">{{ listing.neighborhood.replace('-', ' ').title() }}</span>
                        </p>
                        <div class="card-meta">
                            <span>Size: {{ listing.size }}</span>
                            <span>Posted: {{ listing.created_at.strftime('%b %d') }}</span>
                        </div>
                        <div class="card-actions">
                            <a href="{{ url_for('listing_detail', listing_id=listing._id) }}">
                                <button class="btn message-btn">View Details</button>
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
                
                {% if not high_end_listings %}
                <div style="text-align: center; grid-column: 1 / -1; padding: 2rem;">
                    <p>No high-end listings available at the moment.</p>
                </div>
                {% endif %}
            </div>
        </section>

        <!-- Popular Categories Section -->
        <section>
            <div class="section-header">
                <h2 class="section-title">Popular Categories</h2>
            </div>

            <div class="categories-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1.5rem;">
                {% for category in popular_categories %}
                <div class="category-card" style="background-color: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow); overflow: hidden; text-align: center; transition: transform 0.3s;">
                    <div style="height: 140px; background-color: #f8e9e2; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 2.5rem;">
                            {% if category.name == 'womens' %}👚
                            {% elif category.name == 'mens' %}👔
                            {% elif category.name == 'shoes' %}👟
                            {% elif category.name == 'accessories' %}👜
                            {% elif category.name == 'childrens' %}👶
                            {% else %}👕
                            {% endif %}
                        </span>
                    </div>
                    <div style="padding: 1.25rem;">
                        <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">{{ category.name.replace('_', ' ').title() }}</h3>
                        <p style="color: var(--text-light); font-size: 0.9rem;">{{ category.item_count or 0 }} items</p>
                    </div>
                </div>
                {% endfor %}
                
                {% if not popular_categories %}
                <!-- Default categories if none in database -->
                <div class="category-card" style="background-color: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow); overflow: hidden; text-align: center; transition: transform 0.3s;">
                    <div style="height: 140px; background-color: #f8e9e2; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 2.5rem;">👚</span>
                    </div>
                    <div style="padding: 1.25rem;">
                        <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">Women's Clothing</h3>
                        <p style="color: var(--text-light); font-size: 0.9rem;">Coming Soon</p>
                    </div>
                </div>
                
                <div class="category-card" style="background-color: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow); overflow: hidden; text-align: center; transition: transform 0.3s;">
                    <div style="height: 140px; background-color: #e2e9f8; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 2.5rem;">👔</span>
                    </div>
                    <div style="padding: 1.25rem;">
                        <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">Men's Clothing</h3>
                        <p style="color: var(--text-light); font-size: 0.9rem;">Coming Soon</p>
                    </div>
                </div>
                {% endif %}
            </div>
        </section>

        <!-- How it works section -->
        <section>
            <div class="section-header">
                <h2 class="section-title">How APP Works</h2>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin: 2rem 0;">
                <div style="text-align: center;">
                    <div style="background-color: var(--primary-light); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 2rem;">1</div>
                    <h3 style="margin-bottom: 1rem; color: var(--primary-dark);">List Your Items</h3>
                    <p style="color: var(--text-light);">Take photos and create a listing for your pre-loved clothing items in minutes.</p>
                </div>

                <div style="text-align: center;">
                    <div style="background-color: var(--primary-light); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 2rem;">2</div>
                    <h3 style="margin-bottom: 1rem; color: var(--primary-dark);">Connect Locally</h3>
                    <p style="color: var(--text-light);">Chat with buyers or sellers in your neighborhood through our secure messaging system.</p>
                </div>

                <div style="text-align: center;">
                    <div style="background-color: var(--primary-light); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 2rem;">3</div>
                    <h3 style="margin-bottom: 1rem; color: var(--primary-dark);">Meet & Exchange</h3>
                    <p style="color: var(--text-light);">Arrange a safe local meetup to complete your transaction and give clothes a second life.</p>
                </div>
            </div>

            <div style="text-align: center; margin-top: 2rem;">
                <a href="{{ url_for('how_it_works') }}">
                    <button class="btn btn-accent">Learn More</button>
                </a>
            </div>
        </section>
    </div>

    <!-- Newsletter signup section -->
    <section style="background-color: var(--primary-light); padding: 4rem 2rem; text-align: center; margin-top: 3rem;">
        <div style="max-width: 600px; margin: 0 auto;">
            <h2 style="color: var(--primary-dark); margin-bottom: 1rem;">Join Our Community</h2>
            <p style="color: var(--text-light); margin-bottom: 2rem;">Sign up for our newsletter to stay updated on new listings, sustainable fashion tips, and community events.</p>

            <form style="display: flex; gap: 0.5rem; max-width: 500px; margin: 0 auto;">
                <input type="email" placeholder="Your email address" style="flex: 1; padding: 0.75rem; border: 1px solid var(--border); border-radius: var(--radius); font-size: 1rem;">
                <button type="submit" class="btn">Subscribe</button>
            </form>
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>APP</h3>
                <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 1rem;">Your local marketplace for pre-loved fashion in San Ramon and Danville.</p>
                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <a href="#" style="color: white; font-size: 1.2rem;">📱</a>
                    <a href="#" style="color: white; font-size: 1.2rem;">📘</a>
                    <a href="#" style="color: white; font-size: 1.2rem;">📸</a>
                    <a href="#" style="color: white; font-size: 1.2rem;">🐦</a>
                </div>
            </div>

            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="{{ url_for('home') }}">Home</a></li>
                    <li><a href="{{ url_for('listings') }}">Browse Items</a></li>
                    <li><a href="{{ url_for('sell') }}">Sell Items</a></li>
                    <li><a href="{{ url_for('how_it_works') }}">How It Works</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h3>Categories</h3>
                <ul class="footer-links">
                    <li><a href="{{ url_for('listings', category='womens') }}">Women's Clothing</a></li>
                    <li><a href="{{ url_for('listings', category='mens') }}">Men's Clothing</a></li>
                    <li><a href="{{ url_for('listings', category='shoes') }}">Shoes & Accessories</a></li>
                    <li><a href="{{ url_for('listings', category='childrens') }}">Children's</a></li>
                    <li><a href="{{ url_for('listings', category='activewear') }}">Activewear</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h3>Contact Us</h3>
                <ul class="footer-links">
                    <li><a href="mailto:info@APP.com">info@APP.com</a></li>
                    <li><a href="tel:9255551234">(925) 555-1234</a></li>
                    <li style="color: rgba(255, 255, 255, 0.7);">San Ramon & Danville, CA</li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2025 APP. All rights reserved.</p>
            <p style="margin-top: 0.5rem;">
                <a href="#" style="color: rgba(255, 255, 255, 0.6); margin-right: 1rem;">Privacy Policy</a>
                <a href="#" style="color: rgba(255, 255, 255, 0.6); margin-right: 1rem;">Terms of Service</a>
                <a href="#" style="color: rgba(255, 255, 255, 0.6);">Community Guidelines</a>
            </p>
        </div>
    </footer>

    <!-- JavaScript for interactivity -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Mobile menu toggle
        document.getElementById('mobile-menu-toggle').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.add('active');
            document.getElementById('mobile-menu-overlay').style.display = 'block';
            document.body.style.overflow = 'hidden';
        });

        // Close mobile menu
        document.getElementById('close-mobile-menu').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.remove('active');
            document.getElementById('mobile-menu-overlay').style.display = 'none';
            document.body.style.overflow = 'auto';
        });

        document.getElementById('mobile-menu-overlay').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.remove('active');
            document.getElementById('mobile-menu-overlay').style.display = 'none';
            document.body.style.overflow = 'auto';
        });

    // Category selection
    const categories = document.querySelectorAll('.category');
    categories.forEach(function(category) {
        category.addEventListener('click', function() {
            const categoryValue = this.getAttribute('data-category');
            if (categoryValue === 'all') {
                window.location.href = '{{ url_for("listings") }}';
            } else {
                window.location.href = '{{ url_for("listings") }}?category=' + categoryValue;
            }
        });
    });

    // Like functionality
    const isAuthenticated = "{{ 'true' if current_user.is_authenticated else 'false' }}";
    if (isAuthenticated) {
        const likeButtons = document.querySelectorAll('.like-btn');
        likeButtons.forEach(function(button) {
            button.addEventListener('click', function(e) {
                e.preventDefault();
                const listingId = this.getAttribute('data-listing-id');
                
                fetch('/save_listing/' + listingId, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });
            });
        });
    }


        // Add animation for category cards
        const categoryCards = document.querySelectorAll('.category-card');
        categoryCards.forEach(function(card) {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
            });
    
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    });
    </script>

    <style>
        .flash-messages {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
        }
        
        .alert {
            padding: 12px 20px;
            margin-bottom: 10px;
            border-radius: 4px;
            font-size: 14px;
            max-width: 400px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .card-img-photo {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px 8px 0 0;
        }
        
        .like-btn.liked {
            color: #e74c3c;
        }
        
        .like-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            transition: color 0.3s;
        }
    </style>
</body>
</html>